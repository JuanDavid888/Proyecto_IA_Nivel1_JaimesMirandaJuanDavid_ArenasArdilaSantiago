{
  "name": "AgendaBot",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        1792,
        1120
      ],
      "id": "bed4c885-5b10-451e-a84d-dc1e31e26b4b",
      "name": "Telegram Trigger",
      "webhookId": "c417538b-5766-4202-88a3-1dd12713d5ef",
      "retryOnFail": true,
      "maxTries": 5,
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $json.message.chat.first_name }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        1120
      ],
      "id": "4baa0e9b-862f-4801-8476-4086b4ce5747",
      "name": "Update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2208,
        1120
      ],
      "id": "28b8ad99-c6e8-4923-98d5-ea6e75d21c55",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "9",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "186bad57-c7b2-4213-9622-8703c693f1ea"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "72a54972-047c-4a0d-918e-ade3f6c74074",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "9",
                    "operator": {
                      "type": "string",
                      "operation": "empty",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "8abed294-fd72-4894-9012-22363b325ad7",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "aeafb69b-8506-4933-86e2-a2cb79f7967e",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "AGENDA",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "472d10a6-cf31-4632-830f-8f5a2f6315ea",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "TAREAS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "6d37cf9b-3ea7-4aa2-a6ed-58e4c2c4bf5e",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "AGENDA_EDIT",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "937947ba-45cb-4229-b13e-7421e3a92314",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "AGENDA_DELETE",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "eb2a8ce0-3b63-4d7f-a472-e94f0775ef14",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "AGENDA_COMPLETE",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2432,
        320
      ],
      "id": "3e41a1c1-4b44-4d2b-911b-56addec77b94",
      "name": "Switch"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "pantalla_actual": "MENU",
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "datos_parciales_3": "={{ $json.Vacio }}",
            "datos_parciales_4": "={{ $json.Vacio }}",
            "datos_parciales_5": "={{ $json.Vacio }}",
            "datos_parciales_6": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3296,
        -1776
      ],
      "id": "90d478b5-7106-48fd-96d9-8691784d13ef",
      "name": "Update row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2992,
        -1264
      ],
      "id": "4d547d51-d5ac-43b4-bc47-c5c8c4c95921",
      "name": "Send a text message",
      "webhookId": "67f4070f-d09c-4373-8dcb-d45994d560f6",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "content": "Si el usuario ingresa \"9\" se retornar√° el mensaje de MEN√ö PRINCIPAL en cualquier parte del programa",
        "height": 96,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2640,
        -1296
      ],
      "typeVersion": 1,
      "id": "e5008c83-9d35-4edc-94cc-f6b9ea36e248",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Hola, soy AgendaBot üëã\n\nEstoy aqu√≠ para ayudarte a organizar tus citas, tareas y recordatorios\nde forma sencilla y sin complicaciones.\n\nPuedes escribirme en cualquier momento.\nPara avanzar, solo tienes que escribir el n√∫mero de la opci√≥n que quieras usar.\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nMensaje de orientaci√≥n:\n\nTip r√°pido: escribe solo el n√∫mero (por ejemplo: 1) y presiona enviar.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2992,
        -1072
      ],
      "id": "6331d86f-39bd-4cf5-8c84-2b7075369dd0",
      "name": "Send a text message1",
      "webhookId": "67f4070f-d09c-4373-8dcb-d45994d560f6",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "content": "Cuando el usuario inicia por primera vez se otorgar√° el estado de BIENVENIDA, que es el mensaje de MEN√ö PRINCIPAL con un mensaje especial",
        "height": 112,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2640,
        -1104
      ],
      "typeVersion": 1,
      "id": "484cdf11-7f41-48c0-b14a-2ca660611637",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "0",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "7b4ea7af-adc0-4372-b1ab-6544558c5fe0"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "4f23485a-7f79-47b0-8ab9-0251efd9c614",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "30afad59-fb6a-488e-ae09-a9fb3bab0499",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "a8cb77bc-3bbd-4860-848a-687f4370ea7b",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "d6851864-6261-491d-bdb6-a2d2b809bd1b",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "0ef506af-ce13-4342-a5d2-a95da5c228ad",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "5",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "52dfa6a5-59e1-4f91-a6ec-26f5f5bde465",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "6",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "32470be4-638a-4031-8607-9491ea88d98f",
                    "leftValue": "",
                    "rightValue": "7",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "585d96b9-2639-4e90-83b2-a683e1581626",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "8",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "580946f9-9f32-4ed2-80f1-2e9bc69af212",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "0, 1, 2, 3, 4, 5, 6, 7, 8",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        3424,
        -1136
      ],
      "id": "d219097f-899b-4c81-ab93-4ffb32522d24",
      "name": "Switch1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Este bot funciona con men√∫s num√©ricos y pasos guiados, para que todo sea claro y sin complicaciones. Ten en cuenta lo siguiente:\n\n1Ô∏è‚É£ C√≥mo navegar por los men√∫s\n\nCuando veas un men√∫, responde solo con el n√∫mero de la opci√≥n que quieras usar\nüëâ Ejemplo: 1, 3, 6\n\nNo escribas texto adicional ni comandos como /start.\n\nEl bot siempre te dir√° d√≥nde est√°s y qu√© opciones tienes.\n\nüí° Recomendaci√≥n: si no sabes por d√≥nde empezar, el bot siempre te sugerir√° una opci√≥n.\n\n2Ô∏è‚É£ Ingreso de datos paso a paso\n\nCuando se pida una fecha, usa el formato: YYYY-MM-DD\nEjemplo: 2025-12-20\n\nPara hora, usa formato 24 horas: HH:MM\nEjemplo: 14:30\n\nSi se pide texto (nombre, motivo, t√≠tulo), escribe la informaci√≥n tal cual.\n\nCuando haya opciones, elige solo el n√∫mero correspondiente.\n\nEl bot validar√° la informaci√≥n y te avisar√° si algo no es correcto.\n\n3Ô∏è‚É£ Cancelar o volver atr√°s\n\nEn la mayor√≠a de los pasos puedes escribir:\n9 ‚Üí Cancelar o volver\n\nEl bot nunca guardar√° nada sin pedirte confirmaci√≥n previa.\n\n4Ô∏è‚É£ Si algo no sale como esperas\n\nSi ingresas una opci√≥n inv√°lida, el bot te avisar√° y te mostrar√° nuevamente el men√∫.\n\nTodas las acciones quedan registradas para mantener el control y evitar errores.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3584,
        -1920
      ],
      "id": "70e3df01-21b9-4200-a35e-2b46d455f41b",
      "name": "Send a text message2",
      "webhookId": "2f72050a-901e-4314-9988-37623d8cb50d",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3760,
        -1920
      ],
      "id": "ec137004-1ebb-425e-b253-8144a2814e1f",
      "name": "Send a text message3",
      "webhookId": "e1b34d6a-5286-4830-a7ee-7e8c8ee6f4f6",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "content": "### Opci√≥n 0\nDa indicaciones de ayuda y devuelve al men√∫ principal",
        "height": 96,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        3584,
        -2032
      ],
      "typeVersion": 1,
      "id": "b0d52724-5c08-48c7-a6ab-7bb041b4c8e4",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "pantalla_actual": "MENU",
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3168,
        -1072
      ],
      "id": "7abcb765-4eb1-4791-8882-75df7796b655",
      "name": "Update row in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Perfecto, vamos con tu agenda.\n\n¬øQu√© deseas hacer?\n\n1. Agendar una nueva cita\n2. Consultar tu agenda\n3. Reprogramar una cita\n4. Cancelar una cita\n5. Marcar una cita como completada\n9. Volver al men√∫ principal",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3632,
        -1616
      ],
      "id": "8be267de-2abe-4a58-8cfe-f92505bb3914",
      "name": "Send a text message4",
      "webhookId": "f7cd6eb8-73d2-44f5-a589-cc167c525780",
      "retryOnFail": true,
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Ups, esa opci√≥n no existe en este men√∫.\n\nPor favor escribe uno de los n√∫meros que ves en pantalla.\n\nEst√°s en: Men√∫ principal\nOpciones disponibles: 0 al 8",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3728,
        -800
      ],
      "id": "7a251085-e791-41e6-a37c-9d0a7c2791e5",
      "name": "Send a text message5",
      "webhookId": "621877bc-98ca-497d-99c9-d83042a1ad3b",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "content": "### Opci√≥n 1\nEl sistema proporciona ayuda para el tema de agendas (citas)",
        "height": 96,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        3632,
        -1728
      ],
      "typeVersion": 1,
      "id": "c962eaca-44f5-4603-9d83-1c7198020ea8",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3984,
        -800
      ],
      "id": "061e5e2a-c435-4f2a-aced-faa050c5b46b",
      "name": "Send a text message6",
      "webhookId": "e1b34d6a-5286-4830-a7ee-7e8c8ee6f4f6",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "pantalla_actual": "AGENDA"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3840,
        -1616
      ],
      "id": "5355ebff-bc14-4aa0-bf78-f4cd2e0ce5e2",
      "name": "Update row in sheet3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "1a85befe-a620-4132-a561-0b196f81a961"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "f346127f-5f33-4163-8fd8-fbaa38a6c527",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "c0f971a3-78c3-47f7-bd13-0ccf2ee00f7a",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "0b974eb1-a693-4df3-989d-f7de83649604",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "bcb58231-fbde-4cbf-a34e-0210b6ce55d1",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "5",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "caf44e3f-dabd-4186-b2bc-04f73b1c9f00",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1, 2, 3, 4, 5, 9",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        5760,
        -1344
      ],
      "id": "c96492ad-1e6e-464f-bd3e-463168b61899",
      "name": "Switch2"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Ups, esa opci√≥n no existe en este men√∫.\n\nPor favor escribe uno de los n√∫meros que ves en pantalla.\n\nEst√°s en: Men√∫ agenda\nOpciones disponibles: 1 al 5 y 9",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6016,
        -960
      ],
      "id": "2908d30c-171b-4cba-a315-c30a1aa4a357",
      "name": "Send a text message7",
      "webhookId": "621877bc-98ca-497d-99c9-d83042a1ad3b",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Perfecto, vamos con tu agenda.\n\n¬øQu√© deseas hacer?\n\n1. Agendar una nueva cita\n2. Consultar tu agenda\n3. Reprogramar una cita\n4. Cancelar una cita\n5. Marcar una cita como completada\n9. Volver al men√∫ principal",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6272,
        -960
      ],
      "id": "d692b2bc-86ca-4dc8-816c-a9b40d7287c7",
      "name": "Send a text message8",
      "webhookId": "f7cd6eb8-73d2-44f5-a589-cc167c525780",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Empecemos a crear tu cita.\n\nPaso 1 de 6\n¬øCu√°l es la fecha de la cita?\n\nFormato: YYYY-MM-DD\nEjemplo: 2025-12-20\n\n9. Cancelar",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6016,
        -1872
      ],
      "id": "0eb71285-8f98-442f-ae70-f5904b99a652",
      "name": "Send a text message9",
      "webhookId": "04d65196-2feb-4edd-854d-eb0ed599f44e",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "1"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6272,
        -1872
      ],
      "id": "14a7f071-1809-40c3-8789-548c627f9c1f",
      "name": "Update row in sheet4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "a3ddb291-313f-4568-8978-9f6f7b6b04b4",
              "leftValue": "={{ $json.pantalla_actual }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "3a650540-a31b-458f-b267-408c1c05e8de",
              "leftValue": "={{ $json.paso_actual }}",
              "rightValue": "",
              "operator": {
                "type": "number",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        5136,
        384
      ],
      "id": "a009ac84-78ec-482f-a59a-ec9bc9992a3e",
      "name": "If"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 1,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    },
                    "id": "9fd2951c-f4fc-409b-a856-f3c50d9bd9c4"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "a0ce7a58-945e-4432-beb1-2d357795186e",
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 2,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "0b69caf7-77ca-48a8-ac1a-558155cc516d",
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 3,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "9b0b7bf2-3274-407a-950e-8392c39aa912",
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 4,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "0a90db21-1ee3-4016-ae6e-4dfd7eb90912",
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 5,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "b6c711aa-8613-45b0-8d4a-cdfe694a3fb5",
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 6,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        6848,
        -128
      ],
      "id": "3ce7f380-f893-465e-a7d9-1a6168c375df",
      "name": "Switch3"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $('Telegram Trigger').item.json.message.text }}",
              "operation": "regex",
              "value2": "^\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])$"
            }
          ]
        }
      },
      "id": "45172c84-9fc2-4098-8255-53e44ddbfad7",
      "name": "Validar formato YYYY-MM-DD",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        7696,
        -624
      ]
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Paso 2 de 6\n¬øA qu√© hora ser√° la cita?\n\nFormato 24 horas (HH:MM)\nEjemplo: 14:30\n\n9. Cancelar",
        "additionalFields": {}
      },
      "id": "45b06159-a632-4038-ae05-c628d30e05f6",
      "name": "Telegram OK",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8432,
        -752
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "retryOnFail": true,
      "maxTries": 5,
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Fecha inv√°lida.\nFormato requerido:YYYY-MM-DD\nEjemplo: 2025-12-20\nIntenta nuevamente.",
        "additionalFields": {}
      },
      "id": "c0e8e557-ad86-4cdf-8cb6-92bcbb18afdc",
      "name": "Telegram Error",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8176,
        -512
      ],
      "webhookId": "58122352-e475-4894-bfaf-c3aa5ecc6ce5",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "2",
            "datos_parciales_1": "={{ $('Telegram Trigger').item.json.message.text }}",
            "timestamp_ultima_interaccion": "={{ $now }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8176,
        -752
      ],
      "id": "e65b043f-ec41-40b2-82e6-e638deef6e0c",
      "name": "Update row in sheet5",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $('Telegram Trigger').item.json.message.text }}",
              "operation": "regex",
              "value2": "^([01]\\d|2[0-3]):([0-5]\\d)$"
            }
          ]
        }
      },
      "id": "16942ae9-1e4e-4510-97bf-a8e5a386b136",
      "name": "Validar formato HH:MM",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        7680,
        -192
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "3",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $('Telegram Trigger').item.json.message.text }}",
            "timestamp_ultima_interaccion": "={{ $now }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8432,
        -304
      ],
      "id": "9273faa6-00cc-479b-bb96-49d7d1e212f4",
      "name": "Update row in sheet6",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8176,
        -304
      ],
      "id": "411d4260-0a04-4ef5-ab9e-85a17af474db",
      "name": "Get row(s) in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Fecha inv√°lida.\nFormato requerido:HH:MM\nEjemplo: 14:20\nIntenta nuevamente.",
        "additionalFields": {}
      },
      "id": "da2893e4-eda7-4b18-a385-30d6faa14ef0",
      "name": "Telegram Error1",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8176,
        -112
      ],
      "webhookId": "58122352-e475-4894-bfaf-c3aa5ecc6ce5",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "4",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $json.datos_parciales_2 }}",
            "datos_parciales_3": "={{ $('Telegram Trigger').item.json.message.text }}",
            "timestamp_ultima_interaccion": "={{ $now }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8112,
        48
      ],
      "id": "e684b9d6-9db0-482c-a96f-3a7c2b3bf39a",
      "name": "Update row in sheet7",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        7856,
        48
      ],
      "id": "9029e542-2724-42ba-8a6a-d766c5ef004c",
      "name": "Get row(s) in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Paso 4 de 6\nCu√©ntame brevemente el motivo de la cita.\n\nEjemplo: Asesor√≠a t√©cnica\n\n9. Cancelar",
        "additionalFields": {}
      },
      "id": "5b76e166-f125-4d4b-8efe-91a523e70ea0",
      "name": "Telegram OK2",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8352,
        48
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "5",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $json.datos_parciales_2 }}",
            "datos_parciales_3": "={{ $json.datos_parciales_3 }}",
            "datos_parciales_4": "={{ $('Telegram Trigger').item.json.message.text }}",
            "timestamp_ultima_interaccion": "={{ $now }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8336,
        256
      ],
      "id": "8564f20d-256d-4650-953a-30bb52b98918",
      "name": "Update row in sheet8",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8080,
        256
      ],
      "id": "b1593e86-d79d-488a-a501-72fd809fb7b1",
      "name": "Get row(s) in sheet3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Paso 5 de 6\n¬øC√≥mo ser√° la atenci√≥n?\n\n1. Presencial\n2. Virtual\n3. Llamada\n9. Cancelar",
        "additionalFields": {}
      },
      "id": "d006b69a-c216-4cf3-a671-5a972724a6fa",
      "name": "Telegram OK3",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8576,
        256
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "6",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $json.datos_parciales_2 }}",
            "datos_parciales_3": "={{ $json.datos_parciales_3 }}",
            "datos_parciales_4": "={{ $json.datos_parciales_4 }}",
            "datos_parciales_5": "={{ $('Telegram Trigger').item.json.message.text }}",
            "timestamp_ultima_interaccion": "={{ $now }}",
            "datos_parciales_6": "=Presencial"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8288,
        480
      ],
      "id": "4ac90577-a83a-4242-b7cd-79d619b24652",
      "name": "Update row in sheet10",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8048,
        480
      ],
      "id": "a3aa49f6-0354-4bc0-a3ae-ac41d13a81dd",
      "name": "Get row(s) in sheet5",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita:\n\nFecha: {{ $json.datos_parciales_1 }}\nHora: {{ $json.datos_parciales_2 }}\nCliente: {{ $json.datos_parciales_3 }}\nMotivo: {{ $json.datos_parciales_4 }}\nCanal: Presencial\n\n¬øQu√© deseas hacer?\n1. Confirmar y guardar\n2. Editar informaci√≥n\n3. Cancelar",
        "additionalFields": {}
      },
      "id": "4d4affeb-c40a-4ae9-b700-f404b2138fb9",
      "name": "Telegram OK5",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8528,
        480
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "2149ed1c-6fc1-4214-9bb6-9d73396df7e2"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "c3020235-3026-4758-ba53-3259646bba63",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "81655df1-f7a4-4730-bcb6-91267c74645f",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        7728,
        1584
      ],
      "id": "4945a9e8-fabd-4adc-9be3-bf047a6726fa",
      "name": "Switch4"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e49fdbbd-e95e-42b7-8e48-8b3cb29491bd"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "58855023-5cd0-49ff-8a4e-042adcdf4212",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "b8fa012e-27ac-4322-82c7-41c4c9cad1fa",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "40cb23eb-e6be-426c-a651-7940bc7f2264",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1, 2, 3",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        7664,
        672
      ],
      "id": "5abb6cd8-f784-4154-bb42-18c3cf481ba3",
      "name": "Switch5"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "6",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $json.datos_parciales_2 }}",
            "datos_parciales_3": "={{ $json.datos_parciales_3 }}",
            "datos_parciales_4": "={{ $json.datos_parciales_4 }}",
            "datos_parciales_5": "={{ $('Telegram Trigger').item.json.message.text }}",
            "timestamp_ultima_interaccion": "={{ $now }}",
            "datos_parciales_6": "=Virtual"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8288,
        656
      ],
      "id": "03541bb0-d3fd-401c-abe3-8592591c4f04",
      "name": "Update row in sheet11",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8032,
        656
      ],
      "id": "c8dd00cc-6d27-4bd6-bae9-55c41d95a879",
      "name": "Get row(s) in sheet6",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita:\n\nFecha: {{ $json.datos_parciales_1 }}\nHora: {{ $json.datos_parciales_2 }}\nCliente: {{ $json.datos_parciales_3 }}\nMotivo: {{ $json.datos_parciales_4 }}\nCanal: Virtual\n\n¬øQu√© deseas hacer?\n1. Confirmar y guardar\n2. Editar informaci√≥n\n3. Cancelar",
        "additionalFields": {}
      },
      "id": "1ec56a79-3557-4e9c-a1b5-a262545874a8",
      "name": "Telegram OK6",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8528,
        656
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "6",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $json.datos_parciales_2 }}",
            "datos_parciales_3": "={{ $json.datos_parciales_3 }}",
            "datos_parciales_4": "={{ $json.datos_parciales_4 }}",
            "datos_parciales_5": "={{ $('Telegram Trigger').item.json.message.text }}",
            "timestamp_ultima_interaccion": "={{ $now }}",
            "datos_parciales_6": "=Llamada"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8288,
        848
      ],
      "id": "8578f8fe-374e-4fed-9ffe-9e5f35801e61",
      "name": "Update row in sheet12",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8032,
        848
      ],
      "id": "024ebe5f-9886-4a64-a17b-530a971d89df",
      "name": "Get row(s) in sheet7",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita:\n\nFecha: {{ $json.datos_parciales_1 }}\nHora: {{ $json.datos_parciales_2 }}\nCliente: {{ $json.datos_parciales_3 }}\nMotivo: {{ $json.datos_parciales_4 }}\nCanal: Llamada\n\n¬øQu√© deseas hacer?\n1. Confirmar y guardar\n2. Editar informaci√≥n\n3. Cancelar",
        "additionalFields": {}
      },
      "id": "201d1341-add2-4243-b7af-98d889c00bb0",
      "name": "Telegram OK7",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8528,
        848
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "Opci√≥n no v√°lida.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8032,
        1040
      ],
      "id": "e9b94ecf-e171-4692-8280-d18ab03221fe",
      "name": "Send a text message10",
      "webhookId": "537b6979-63b9-49c5-8610-35f1ef19571a",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8608,
        1488
      ],
      "id": "88ac855c-bb54-4363-b0b8-2e692e7c66f3",
      "name": "Get row(s) in sheet8",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "hora": "={{ $('Get row(s) in sheet8').item.json.datos_parciales_2 }}",
            "fecha": "={{ $('Get row(s) in sheet8').item.json.datos_parciales_1 }}",
            "nombre": "={{ $('Get row(s) in sheet8').item.json.datos_parciales_3 }}",
            "motivo": "={{ $('Get row(s) in sheet8').item.json.datos_parciales_4 }}",
            "canal": "={{ $('Get row(s) in sheet8').item.json.datos_parciales_6 }}",
            "timestamp_creacion": "={{ $now }}",
            "estado": "={{ $json.estado }}",
            "creado_por": "={{ $('Get row(s) in sheet8').item.json.telegram_user }}",
            "id_cita": "={{ $('Code in JavaScript').item.json.id_cita }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "id_cita",
              "displayName": "id_cita",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "hora",
              "displayName": "hora",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "motivo",
              "displayName": "motivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "canal",
              "displayName": "canal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_creacion",
              "displayName": "timestamp_creacion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9120,
        1488
      ],
      "id": "1be28a22-349f-4153-833e-6947f3b5e3b4",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{$node[\"Edit Fields1\"].json.ChatIdSet}}\n",
        "text": "Agenda completada.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        9360,
        1440
      ],
      "id": "3fb9e420-feda-4be6-8229-0ebe075ba8b2",
      "name": "Send a text message11",
      "webhookId": "3467d3a3-b94f-4550-b6ce-a4b5b14025a0",
      "retryOnFail": true,
      "maxTries": 5,
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "=",
            "pantalla_actual": "MENU",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "datos_parciales_3": "={{ $json.Vacio }}",
            "datos_parciales_4": "={{ $json.Vacio }}",
            "datos_parciales_5": "={{ $json.Vacio }}",
            "datos_parciales_6": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9760,
        1488
      ],
      "id": "8fa45e16-6942-4ff9-ae08-052fc368405c",
      "name": "Update row in sheet13",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "MENU"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8128,
        1856
      ],
      "id": "33747132-5d8c-492e-b165-ca20ca168fd6",
      "name": "Update row in sheet14",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "Cancelado",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8384,
        1856
      ],
      "id": "4510ea30-c0d3-403e-9918-8f7263a6af18",
      "name": "Send a text message12",
      "webhookId": "dc8a9a45-0711-45a4-829a-7ab666828377",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA",
            "paso_actual": "1"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8128,
        1664
      ],
      "id": "da92d9f7-c44e-428b-a7d8-cc7216491f95",
      "name": "Update row in sheet15",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Empecemos a crear tu cita.\n\nPaso 1 de 6\n¬øCu√°l es la fecha de la cita?\n\nFormato: YYYY-MM-DD\nEjemplo: 2025-12-20\n\n9. Cancelar",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8336,
        1664
      ],
      "id": "93743e16-9449-42b3-8dc6-35778653c1db",
      "name": "Send a text message13",
      "webhookId": "04d65196-2feb-4edd-854d-eb0ed599f44e",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Paso 3 de 6\n¬øA nombre de qui√©n es la cita?\n\nEscribe el nombre completo.\n\n9. Cancelar",
        "additionalFields": {}
      },
      "id": "ce4f6f9e-77a6-4de6-adb5-6932c13e59ef",
      "name": "Telegram OK1",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8672,
        -304
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Perfecto, vamos con tu tarea.\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n2. Consultar tus tareas\n3. Reprogramar una tarea\n4. Cancelar una tarea\n5. Marcar una tarea como completada\n9. Volver al men√∫ principal",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3632,
        -1440
      ],
      "id": "494f39c5-a2a6-4d5c-8003-5bbf6bc527bb",
      "name": "Send a text message14",
      "webhookId": "928178ae-ec5a-433b-af9a-0e3142214c88",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "pantalla_actual": "TAREAS"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3840,
        -1440
      ],
      "id": "9faafc76-f02a-455b-836b-943e341c79d2",
      "name": "Update row in sheet16",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "specifyRangeA1",
              "range": "A:A"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8128,
        1488
      ],
      "id": "5ca71f0e-30fc-4a10-a483-dc1486382ab3",
      "name": "Get row(s) in sheet4",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const rows = items;\n\n// Extraer IDs v√°lidos\nconst ids = rows\n  .map(r => r.json.id_cita)\n  .filter(id => typeof id === 'string' && /^CITA-\\d+$/.test(id));\n\n// Si no hay IDs v√°lidos, iniciar contador\nif (ids.length === 0) {\n  return [{\n    json: {\n      id_cita: 'CITA-001'\n    }\n  }];\n}\n\n// Ordenar y obtener el √∫ltimo\nids.sort((a, b) => {\n  const numA = parseInt(a.split('-')[1], 10);\n  const numB = parseInt(b.split('-')[1], 10);\n  return numA - numB;\n});\n\nconst lastId = ids[ids.length - 1];\nconst lastNumber = parseInt(lastId.split('-')[1], 10);\nconst newNumber = lastNumber + 1;\n\n// Formato final\nconst newId = `CITA-${String(newNumber).padStart(3, '0')}`;\nconst chatId = $node[\"Telegram Trigger\"].json.message.chat.id;\n\nreturn [{\n  json: {\n    id_cita: newId,\n    chatId: chatId\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        8336,
        1488
      ],
      "id": "c7bd3561-26fa-49e3-afb2-b8a7ac1794b7",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "jsCode": "\nconst fecha = $input.first().json.datos_parciales_1; // YYYY-MM-DD\nconst hora = $input.first().json.datos_parciales_2;  // HH:mm\n\nif (!fecha || !hora) {\n  return [{\n    json: {\n      estado: 'Pendiente'\n    }\n  }];\n}\n\nconst fechaCita = new Date(`${fecha}T${hora}:00`);\n\nconst ahora = new Date();\n\nconst estado = fechaCita < ahora ? 'Completada' : 'Pendiente';\n\n\nreturn [{\n  json: {\n    estado\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        8848,
        1488
      ],
      "id": "60955a0f-aca0-4e83-983f-c4648a6e91d5",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "chatId": "={{$node[\"Edit Fields1\"].json.ChatIdSet}}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        9984,
        1360
      ],
      "id": "ef3a2cf2-a0e3-4f82-96ba-59c274941762",
      "name": "Send a text message22",
      "webhookId": "67f4070f-d09c-4373-8dcb-d45994d560f6",
      "retryOnFail": true,
      "maxTries": 5,
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d825242d-7e8d-42fc-9944-3a651f639662",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        9568,
        1488
      ],
      "id": "f99b2c07-bfc3-49a5-85a0-a86342b411aa",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "00f95317-6445-4f77-97b8-debb368c783f",
              "name": "ChatIdSet",
              "value": "={{ $json.chatId }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        8704,
        1296
      ],
      "id": "21d51d7e-7fa3-43bd-88e4-689b620d4074",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6048,
        -1664
      ],
      "id": "bf75e962-97b6-404e-8724-73f3fc13176a",
      "name": "Get row(s) in sheet14",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "\nconst pendientes = items\n  .map(i => i.json)\n  .filter(cita => cita.estado === 'Pendiente');\n\nif (pendientes.length === 0) {\n  return [{\n    json: {\n      mensaje: 'No tienes citas pendientes en la agenda.'\n    }\n  }];\n}\n\nlet mensaje = 'üìÖ *Citas pendientes*\\n\\n';\n\npendientes.forEach((cita, index) => {\n  mensaje +=\n    `${index + 1}. *${cita.id_cita}*\\n` +\n    `${cita.nombre}\\n` +\n    `${cita.fecha} ‚è∞ ${cita.hora}\\n` +\n    `${cita.motivo}\\n` +\n    `${cita.canal}\\n\\n`;\n});\n\nconst chatId = $node[\"Telegram Trigger\"].json.message.chat.id;\n\nreturn [{\n  json: {\n    mensaje,\n    chatId: chatId\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6288,
        -1664
      ],
      "id": "eb148d3a-79ec-4050-bbe6-182688876038",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.mensaje }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6496,
        -1664
      ],
      "id": "10bb2d62-4d00-4afc-bc0f-2de52d5eb02d",
      "name": "Send a text message23",
      "webhookId": "85b21991-fc09-4cf9-ae30-9158610be872",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $json.result.chat.first_name }}",
            "pantalla_actual": "MENU"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6704,
        -1664
      ],
      "id": "8dd5abac-c01a-461a-aec9-27cdc723a3f2",
      "name": "Update row in sheet9",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "Perfecto, vamos con tu agenda.\n\n¬øQu√© deseas hacer?\n\n1. Agendar una nueva cita\n2. Consultar tu agenda\n3. Reprogramar una cita\n4. Cancelar una cita\n5. Marcar una cita como completada\n9. Volver al men√∫ principal",
        "height": 80,
        "width": 432
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5280,
        -1504
      ],
      "typeVersion": 1,
      "id": "b1bd0c03-a8c9-4a6f-8dd5-5425af55e988",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Por favor, escribe el ID de la cita que deseas reprogramar.\nEjemplo: CITA-003\n",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6048,
        -1472
      ],
      "id": "9f8fb788-4ee6-4ba8-ab88-6cc98f934a28",
      "name": "Send a text message24",
      "webhookId": "6d97bd7b-0b97-4ed2-9ff8-a3a9d569216b",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA_EDIT",
            "paso_actual": ""
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6256,
        -1472
      ],
      "id": "2a95abc4-1446-44d0-b492-1aafcd1675b6",
      "name": "Update row in sheet20",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3536,
        2192
      ],
      "id": "7d63fbd2-66a7-464a-bb2a-2e7d2880b699",
      "name": "Get row(s) in sheet15",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const idIngresado = $node[\"Telegram Trigger\"].json.message.text.trim().toUpperCase();\nconst citas = items.map(i => i.json);\n\nconst cita = citas.find(c => c.id_cita === idIngresado);\n\nif (!cita) {\n  return [{\n    json: {\n      error: 'No se encontr√≥ una cita con ese ID. Int√©ntalo nuevamente.'\n    }\n  }];\n}\n\nif (cita.estado !== 'Pendiente') {\n  return [{\n    json: {\n      error: 'Solo se pueden editar citas en estado Pendiente.'\n    }\n  }];\n}\n\nreturn [{\n  json: {\n    id_cita: cita.id_cita,\n    rowNumber: cita.rowNumber,\n    estado_actual: cita.estado\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3776,
        2192
      ],
      "id": "6a8993ac-2be8-4c62-9003-a74a680271ae",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "f176d09d-3f91-48cd-b6cd-4224a025f519",
              "leftValue": "={{ $json.error }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3984,
        2192
      ],
      "id": "c913a6b6-1970-4edf-9c4b-afa8596e304e",
      "name": "If2"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $node[\"Telegram Trigger\"].json.message.chat.first_name }} ",
            "pantalla_actual": "AGENDA_EDIT",
            "datos_parciales_1": "={{ $node[\"Telegram Trigger\"].json.message.text }}",
            "paso_actual": "AGENDA_EDICION"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4400,
        2256
      ],
      "id": "544b24e4-faf3-462c-afad-a2032066c7b1",
      "name": "Update row in sheet21",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "19cf076b-a41a-4007-bbc5-e4b072ed2ed2",
              "leftValue": "={{ $('Get row(s) in sheet').item.json.paso_actual }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3136,
        2544
      ],
      "id": "3e2417de-fa8b-4a87-9994-d173d2dba301",
      "name": "If3"
    },
    {
      "parameters": {
        "chatId": "={{$node[\"Telegram Trigger\"].json.message.chat.id}}",
        "text": "={{ $('Code in JavaScript3').item.json.error }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4400,
        2048
      ],
      "id": "e7f42a04-2ba6-454b-9671-9debd32e09e4",
      "name": "Send a text message25",
      "webhookId": "6aead782-f551-42fd-94be-6a582ce924f8",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger\"].json.message.chat.id }} ",
        "text": "=¬øQu√© deseas modificar de la cita {{$json.datos_parciales_1}}?\n\n1) Fecha\n2) Hora\n3) Cancelar",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4640,
        2256
      ],
      "id": "dd7513bc-cf6f-4378-af21-2249b3a8e02b",
      "name": "Send a text message26",
      "webhookId": "0143dc20-4f34-4126-a2f0-8aeb18b64112",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "ec675a21-b990-4a0b-b606-021f5e25e71e"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "7b9cae24-63de-4dba-82a2-9102b9d8c34b",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "dca7b002-8fba-4618-add1-6e508cc3f0ef",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        4048,
        2672
      ],
      "id": "3c098ce5-a9b9-4458-bf4b-36a6937e16ee",
      "name": "Switch10"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "d9a64f2e-d27d-4b36-9cb0-93827b2a3636",
              "leftValue": "={{ $('Get row(s) in sheet').item.json.datos_parciales_2.toString() }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3552,
        2960
      ],
      "id": "f9aafdb0-5843-40dd-887f-3ce521f1674d",
      "name": "If4"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $('Telegram Trigger').item.json.message.text }}",
              "operation": "regex",
              "value2": "^\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])$"
            }
          ]
        }
      },
      "id": "84111646-1d96-456a-924f-3410b7d83f77",
      "name": "Validar formato YYYY-MM-DD2",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        4368,
        3136
      ]
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Fecha actualizada.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "id": "d66be4b2-286e-4326-82c7-76a3f3663bbe",
      "name": "Telegram OK4",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        6080,
        3008
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "retryOnFail": true,
      "maxTries": 5,
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Fecha inv√°lida.\nFormato requerido:YYYY-MM-DD\nEjemplo: 2025-12-20\nIntenta nuevamente.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "id": "9137a41d-c18b-4921-a266-a9fa35e136d8",
      "name": "Telegram Error3",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        4848,
        3248
      ],
      "webhookId": "58122352-e475-4894-bfaf-c3aa5ecc6ce5",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA_EDIT",
            "paso_actual": "AGENDA_EDICION",
            "datos_parciales_1": "={{ $('Get row(s) in sheet').item.json.datos_parciales_1 }}",
            "timestamp_ultima_interaccion": "={{ $now }}",
            "datos_parciales_2": "={{ $('Telegram Trigger').item.json.message.text }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4848,
        3008
      ],
      "id": "dae837b0-cac5-44e4-acde-f6bfae1ffba9",
      "name": "Update row in sheet23",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Ingrese la fecha.\nFormato requerido:YYYY-MM-DD\nEjemplo: 2025-12-20",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4416,
        2448
      ],
      "id": "180260b8-c91d-4451-9bc6-221e8c281518",
      "name": "Send a text message27",
      "webhookId": "091ffb67-df42-49eb-a2b1-1e8a031acfc4",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.from.first_name }}",
            "pantalla_actual": "AGENDA_EDIT",
            "paso_actual": "AGENDA_EDICION",
            "datos_parciales_1": "={{ $('Get row(s) in sheet16').item.json.datos_parciales_1 }}",
            "row_number": 2,
            "datos_parciales_2": "1",
            "timestamp_ultima_interaccion": "={{ $now }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4640,
        2448
      ],
      "id": "31d38c8e-0bd1-4bd7-8c39-e3c4fd92cf98",
      "name": "Update row in sheet29",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3840,
        2688
      ],
      "id": "170ed05b-bdb1-40d7-9dbc-ada77b7ff5a7",
      "name": "Get row(s) in sheet16",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Ingrese la hora.\nFormato requerido:HH:MM\nEjemplo: 12:20",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4416,
        2656
      ],
      "id": "986c0fb7-e0a2-405e-b433-dd9c13d8a3b6",
      "name": "Send a text message28",
      "webhookId": "091ffb67-df42-49eb-a2b1-1e8a031acfc4",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.from.first_name }}",
            "pantalla_actual": "AGENDA_EDIT",
            "paso_actual": "AGENDA_EDICION",
            "datos_parciales_1": "={{ $('Get row(s) in sheet16').item.json.datos_parciales_1 }}",
            "row_number": 2,
            "datos_parciales_2": "2",
            "timestamp_ultima_interaccion": "={{ $now }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4624,
        2656
      ],
      "id": "2c75f71b-3120-4872-9928-1572b8b1a6b3",
      "name": "Update row in sheet30",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "pantalla_actual": "MENU",
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4864,
        2848
      ],
      "id": "93aaaa91-bf25-49ce-a518-d505357e15cd",
      "name": "Update row in sheet31",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4416,
        2848
      ],
      "id": "459cf4b9-6bce-4edd-a63f-812abc6fd2b7",
      "name": "Send a text message29",
      "webhookId": "67f4070f-d09c-4373-8dcb-d45994d560f6",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6ec5bccf-438b-4d68-8947-62e86d961fc3",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4656,
        2848
      ],
      "id": "3b8aebd7-6904-4325-a677-267225d093c6",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Get row(s) in sheet').item.json.datos_parciales_2.toString() }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "74aab308-0919-4efd-b14d-4c702a1df543"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "df6b2b69-9f3c-4db6-ba69-cf31f436ee23",
                    "leftValue": "={{ $('Get row(s) in sheet').item.json.datos_parciales_2.toString() }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        3872,
        3344
      ],
      "id": "c8c16bec-02e6-4259-ad28-fd5304ae9e9b",
      "name": "Switch11"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $('Telegram Trigger').item.json.message.text }}",
              "operation": "regex",
              "value2": "^([01]\\d|2[0-3]):([0-5]\\d)$"
            }
          ]
        }
      },
      "id": "8a42b935-8a21-4d51-886c-c9791dd451ec",
      "name": "Validar formato HH:MM1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        4352,
        3552
      ]
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Fecha inv√°lida.\nFormato requerido:HH:MM\nEjemplo: 14:20\nIntenta nuevamente.",
        "additionalFields": {}
      },
      "id": "1975cf33-d146-4e77-8b91-31bad9f731e0",
      "name": "Telegram Error4",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        4848,
        3632
      ],
      "webhookId": "58122352-e475-4894-bfaf-c3aa5ecc6ce5",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Hora actualizada.",
        "additionalFields": {}
      },
      "id": "8146ea57-3457-4bcf-bcdb-1092d250c7f7",
      "name": "Telegram OK13",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        6112,
        3440
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_cita": "={{ $('Get row(s) in sheet').item.json.datos_parciales_1 }}",
            "fecha": "={{ $('Get row(s) in sheet').item.json.datos_parciales_2 }}",
            "hora": "={{ $json.hora }}"
          },
          "matchingColumns": [
            "id_cita"
          ],
          "schema": [
            {
              "id": "id_cita",
              "displayName": "id_cita",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "hora",
              "displayName": "hora",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "motivo",
              "displayName": "motivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "canal",
              "displayName": "canal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_creacion",
              "displayName": "timestamp_creacion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5328,
        3008
      ],
      "id": "75527b72-3f37-4655-8578-d5cce43e57ce",
      "name": "Update row in sheet33",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA_EDIT",
            "paso_actual": "AGENDA_EDICION",
            "datos_parciales_1": "={{ $('Get row(s) in sheet').item.json.datos_parciales_1 }}",
            "timestamp_ultima_interaccion": "={{ $now }}",
            "datos_parciales_2": "={{ $('Telegram Trigger').item.json.message.text }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4832,
        3440
      ],
      "id": "b6321d35-bd03-451d-bce7-3ec199d46abc",
      "name": "Update row in sheet32",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_cita": "={{ $('Get row(s) in sheet').item.json.datos_parciales_1 }}",
            "fecha": "={{ $json.fecha }}",
            "hora": "={{ $('Get row(s) in sheet').item.json.datos_parciales_2 }}"
          },
          "matchingColumns": [
            "id_cita"
          ],
          "schema": [
            {
              "id": "id_cita",
              "displayName": "id_cita",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "hora",
              "displayName": "hora",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "motivo",
              "displayName": "motivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "canal",
              "displayName": "canal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_creacion",
              "displayName": "timestamp_creacion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5328,
        3440
      ],
      "id": "1266bfb9-5679-4664-988e-11ab28f732ff",
      "name": "Update row in sheet34",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "7a039b49-2c5e-4e19-8dc1-35eabd92e9e2",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        5584,
        3008
      ],
      "id": "7cd8cd7a-da37-4f22-8d3a-753f424088fc",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "MENU",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "datos_parciales_3": "={{ $json.Vacio }}",
            "datos_parciales_4": "={{ $json.Vacio }}",
            "datos_parciales_5": "={{ $json.Vacio }}",
            "datos_parciales_6": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5840,
        3008
      ],
      "id": "2f6fd5b9-929d-4c3c-8d91-c826ffb82197",
      "name": "Update row in sheet35",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "7a039b49-2c5e-4e19-8dc1-35eabd92e9e2",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        5584,
        3440
      ],
      "id": "6af1b1e6-bf92-4101-b2d5-7c20e17c28ef",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.from.first_name }}",
            "pantalla_actual": "MENU",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "datos_parciales_3": "={{ $json.Vacio }}",
            "datos_parciales_4": "={{ $json.Vacio }}",
            "datos_parciales_5": "={{ $json.Vacio }}",
            "datos_parciales_6": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5840,
        3440
      ],
      "id": "05e958be-889f-4ee0-ae91-c03c4f2e2f41",
      "name": "Update row in sheet36",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6304,
        3008
      ],
      "id": "8e04d798-c1cc-455c-b702-91e01e86d83d",
      "name": "Send a text message30",
      "webhookId": "67f4070f-d09c-4373-8dcb-d45994d560f6",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6336,
        3440
      ],
      "id": "d0545fa9-f5cd-4eb1-80fd-79f51408c098",
      "name": "Send a text message31",
      "webhookId": "67f4070f-d09c-4373-8dcb-d45994d560f6",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9825738e-fa38-494e-9dec-f8d4c8bff8d2",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3136,
        -1536
      ],
      "id": "98e88151-9832-4709-9cf8-8cd44022a03e",
      "name": "Edit Fields5"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "id_cita",
              "lookupValue": "={{ $json.datos_parciales_1 }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5072,
        3440
      ],
      "id": "916d4a93-bfd8-44f0-ac0c-38ade8785b37",
      "name": "Get row(s) in sheet17",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "id_cita",
              "lookupValue": "={{ $json.datos_parciales_1 }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5088,
        3008
      ],
      "id": "252b7633-8b52-47df-b48c-6bcc6d9f3bca",
      "name": "Get row(s) in sheet18",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Por favor, escribe el ID de la cita que deseas eliminar.\nEjemplo: CITA-003\n",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6048,
        -1296
      ],
      "id": "b6fa2099-0559-46b1-a692-4ff2bd5b23d7",
      "name": "Send a text message32",
      "webhookId": "6d97bd7b-0b97-4ed2-9ff8-a3a9d569216b",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA_DELETE"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6256,
        -1296
      ],
      "id": "63a56cca-089a-48cd-960b-31d7b68c8f3e",
      "name": "Update row in sheet37",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3744,
        4272
      ],
      "id": "100a7a5e-03e7-4296-8947-7bb9ea295376",
      "name": "Get row(s) in sheet19",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const idIngresado = $node[\"Telegram Trigger\"].json.message.text.trim().toUpperCase();\nconst citas = items.map(i => i.json);\n\nconst cita = citas.find(c => c.id_cita === idIngresado);\n\nif (!cita) {\n  return [{\n    json: {\n      error: 'No se encontr√≥ una cita con ese ID. Int√©ntalo nuevamente.'\n    }\n  }];\n}\n\nif (cita.estado !== 'Pendiente') {\n  return [{\n    json: {\n      error: 'Solo se pueden editar citas en estado Pendiente.'\n    }\n  }];\n}\n\nreturn [{\n  json: {\n    id_cita: cita.id_cita,\n    rowNumber: cita.rowNumber,\n    estado_actual: cita.estado\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3984,
        4272
      ],
      "id": "93ad9f25-1a49-4e9a-94db-2409ab9ddab0",
      "name": "Code in JavaScript4"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "f176d09d-3f91-48cd-b6cd-4224a025f519",
              "leftValue": "={{ $json.error }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        4192,
        4272
      ],
      "id": "a354daa0-bcf9-4a52-a3c2-e831c138b2a3",
      "name": "If5"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $node[\"Telegram Trigger\"].json.message.chat.first_name }} ",
            "pantalla_actual": "AGENDA_DELETE",
            "datos_parciales_1": "={{ $node[\"Telegram Trigger\"].json.message.text }}",
            "paso_actual": "DELETE2"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4608,
        4336
      ],
      "id": "19dd1182-a8e0-4850-b54f-b1c8227de880",
      "name": "Update row in sheet38",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "19cf076b-a41a-4007-bbc5-e4b072ed2ed2",
              "leftValue": "={{ $('Get row(s) in sheet').item.json.paso_actual }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3344,
        4624
      ],
      "id": "5bb962ae-2019-48fe-8f6e-2f6c9e3c0e8e",
      "name": "If6"
    },
    {
      "parameters": {
        "chatId": "={{$node[\"Telegram Trigger\"].json.message.chat.id}}",
        "text": "={{ $('Code in JavaScript4').item.json.error }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4608,
        4128
      ],
      "id": "c4cde0e5-6d3d-4273-a762-bb133a969223",
      "name": "Send a text message33",
      "webhookId": "6aead782-f551-42fd-94be-6a582ce924f8",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger\"].json.message.chat.id }} ",
        "text": "=¬øEstas seguro/a de querer eliminar la cita con ID {{$json.datos_parciales_1}}?\n\n1) Si\n2) Cancear",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4848,
        4336
      ],
      "id": "93acfddb-8e18-4633-8e57-1d9d99649143",
      "name": "Send a text message34",
      "webhookId": "0143dc20-4f34-4126-a2f0-8aeb18b64112",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "startIndex": "={{ $json.row_number }}"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4624,
        4848
      ],
      "id": "873e4e2c-8bc6-4c2b-b65a-69fde5d1fa9f",
      "name": "Delete rows or columns from sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "ce164293-e156-447c-a402-9c7ca61cced3",
              "leftValue": "={{ $('Telegram Trigger').item.json.message.text.toString() }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3888,
        4992
      ],
      "id": "5390ee25-c9dc-44ac-909b-7bccc5328000",
      "name": "If7"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "id_cita",
              "lookupValue": "={{ $json.datos_parciales_1 }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4400,
        4848
      ],
      "id": "bd361cc0-8631-499c-90d2-a215669afce2",
      "name": "Get row(s) in sheet20",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4160,
        4848
      ],
      "id": "4099d9b3-53e0-4d50-a328-17c5f8e4ed21",
      "name": "Get row(s) in sheet21",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "Registro eliminado.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        5216,
        4848
      ],
      "id": "811be460-d311-4031-8a28-e53a0ed15f70",
      "name": "Send a text message35",
      "webhookId": "2fc1d56f-664b-4d51-8648-04c81e4ae6dd",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        5424,
        4848
      ],
      "id": "8c13a43d-b10f-43b3-8f56-2ea3f57ae463",
      "name": "Send a text message36",
      "webhookId": "e2b25fb4-3e1b-4601-b419-20a208b6776c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "Proceso cancelado.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4144,
        5120
      ],
      "id": "8071acd2-aecc-4f4c-90da-2fac12edf486",
      "name": "Send a text message37",
      "webhookId": "4f13f1d8-19ba-4d12-baa8-c36850443a16",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4832,
        5120
      ],
      "id": "447a969e-cf46-4337-b2fa-063a0b529fb1",
      "name": "Send a text message38",
      "webhookId": "e2b25fb4-3e1b-4601-b419-20a208b6776c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "MENU",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "datos_parciales_3": "={{ $json.Vacio }}",
            "datos_parciales_4": "={{ $json.Vacio }}",
            "datos_parciales_5": "={{ $json.Vacio }}",
            "datos_parciales_6": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5024,
        4848
      ],
      "id": "eb650560-676e-4aef-b9ea-a8b720456ccc",
      "name": "Update row in sheet39",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d96b111a-3d75-4653-acf6-0ac987841386",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4832,
        4848
      ],
      "id": "4a507e1c-6e4f-4127-868b-481500e0082e",
      "name": "Edit Fields6"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "MENU",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "datos_parciales_3": "={{ $json.Vacio }}",
            "datos_parciales_4": "={{ $json.Vacio }}",
            "datos_parciales_5": "={{ $json.Vacio }}",
            "datos_parciales_6": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4592,
        5120
      ],
      "id": "6ae2f202-6955-4b35-9e37-18fcbc74d78c",
      "name": "Update row in sheet40",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d96b111a-3d75-4653-acf6-0ac987841386",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4400,
        5120
      ],
      "id": "9d6ecc63-a60b-41f2-82ef-ca053596f0d1",
      "name": "Edit Fields7"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "AGENDA_COMPLETE"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6240,
        -1120
      ],
      "id": "63c64de0-9388-498d-a24b-39ebd0e12ca6",
      "name": "Update row in sheet41",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "19cf076b-a41a-4007-bbc5-e4b072ed2ed2",
              "leftValue": "={{ $('Get row(s) in sheet').item.json.paso_actual.toString() }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3296,
        5744
      ],
      "id": "b4ec0121-384c-425d-8682-691a625ba8ed",
      "name": "If8"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "estado",
              "lookupValue": "Pendiente"
            }
          ]
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3824,
        5568
      ],
      "id": "5f570260-9e72-4067-84c6-d1aacb51bae7",
      "name": "Get row(s) in sheet22",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const idIngresado = $node[\"Telegram Trigger\"].json.message.text.trim().toUpperCase();\nconst citas = items.map(i => i.json);\n\nconst cita = citas.find(c => c.id_cita === idIngresado);\n\nif (!cita) {\n  return [{\n    json: {\n      error: 'No se encontr√≥ una cita con ese ID. Int√©ntalo nuevamente.'\n    }\n  }];\n}\n\nif (cita.estado !== 'Pendiente') {\n  return [{\n    json: {\n      error: 'Solo se pueden editar citas en estado Pendiente.'\n    }\n  }];\n}\n\nreturn [{\n  json: {\n    id_cita: cita.id_cita,\n    rowNumber: cita.rowNumber,\n    estado_actual: cita.estado\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4064,
        5568
      ],
      "id": "ee1e2dfe-232e-4bbf-8d24-e6fd1482bb42",
      "name": "Code in JavaScript5"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "f176d09d-3f91-48cd-b6cd-4224a025f519",
              "leftValue": "={{ $json.error }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        4272,
        5568
      ],
      "id": "38533a9e-26fb-40a1-a170-a288c64b3fbb",
      "name": "If9"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $node[\"Telegram Trigger\"].json.message.chat.first_name }} ",
            "pantalla_actual": "AGENDA_DELETE",
            "datos_parciales_1": "={{ $node[\"Telegram Trigger\"].json.message.text }}",
            "paso_actual": "COMPLETE"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4688,
        5632
      ],
      "id": "b5140b51-c463-4214-a36f-a4c44d960ae4",
      "name": "Update row in sheet42",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{$node[\"Telegram Trigger\"].json.message.chat.id}}",
        "text": "={{ $('Code in JavaScript5').item.json.error }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4688,
        5424
      ],
      "id": "e080c353-4d26-4f12-86ea-15160f24aa5e",
      "name": "Send a text message40",
      "webhookId": "6aead782-f551-42fd-94be-6a582ce924f8",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger\"].json.message.chat.id }} ",
        "text": "=¬øEstas seguro/a de querer completar la cita con ID {{$json.datos_parciales_1}}?\n\n1) Si\n2) Cancear",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4928,
        5632
      ],
      "id": "a1905638-6835-4709-adf0-2486600d5db9",
      "name": "Send a text message41",
      "webhookId": "0143dc20-4f34-4126-a2f0-8aeb18b64112",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "id_cita",
              "lookupValue": "={{ $json.datos_parciales_1 }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3872,
        5920
      ],
      "id": "34416442-e7a9-4640-8ca7-5b107ccb750a",
      "name": "Get row(s) in sheet23",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "Se actualiz√≥ la informaci√≥n.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        4880,
        5920
      ],
      "id": "5dcea403-b95f-4163-94df-9c8e4b232a57",
      "name": "Send a text message42",
      "webhookId": "2fc1d56f-664b-4d51-8648-04c81e4ae6dd",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        5088,
        5920
      ],
      "id": "bfb7973b-e68f-4f92-ad09-df685da8f06b",
      "name": "Send a text message43",
      "webhookId": "e2b25fb4-3e1b-4601-b419-20a208b6776c",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "MENU",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "datos_parciales_3": "={{ $json.Vacio }}",
            "datos_parciales_4": "={{ $json.Vacio }}",
            "datos_parciales_5": "={{ $json.Vacio }}",
            "datos_parciales_6": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4688,
        5920
      ],
      "id": "d7b60202-56ba-4b21-a10f-261c626e75af",
      "name": "Update row in sheet43",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d96b111a-3d75-4653-acf6-0ac987841386",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4496,
        5920
      ],
      "id": "ede01585-e5f6-482f-b905-3a6a6f74e431",
      "name": "Edit Fields8"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Por favor, escribe el ID de la cita que deseas completar.\nEjemplo: CITA-003\n",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        6032,
        -1120
      ],
      "id": "08705e4b-2433-4766-81ab-ade9c5a18582",
      "name": "Send a text message39",
      "webhookId": "6d97bd7b-0b97-4ed2-9ff8-a3a9d569216b",
      "credentials": {
        "telegramApi": {
          "id": "YMdv2aeMU5U6FQ85",
          "name": "Agenda bot"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_cita": "={{ $('Get row(s) in sheet').item.json.datos_parciales_1 }}",
            "estado": "Completada",
            "fecha": "={{ $json.fecha }}",
            "hora": "={{ $json.hora }}",
            "nombre": "={{ $json.nombre }}",
            "motivo": "={{ $json.motivo }}",
            "canal": "={{ $json.canal }}",
            "creado_por": "={{ $json.creado_por }}",
            "timestamp_creacion": "={{ $json.timestamp_creacion }}"
          },
          "matchingColumns": [
            "id_cita"
          ],
          "schema": [
            {
              "id": "id_cita",
              "displayName": "id_cita",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "hora",
              "displayName": "hora",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "motivo",
              "displayName": "motivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "canal",
              "displayName": "canal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_creacion",
              "displayName": "timestamp_creacion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4192,
        5920
      ],
      "id": "329bc854-716d-42ce-a29d-66e0506fa38a",
      "name": "Update row in sheet44",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "hG2KjqFn0nRxAqmP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "a3ddb291-313f-4568-8978-9f6f7b6b04b4",
              "leftValue": "={{ $json.pantalla_actual }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "3a650540-a31b-458f-b267-408c1c05e8de",
              "leftValue": "={{ $json.paso_actual }}",
              "rightValue": "",
              "operator": {
                "type": "number",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        7424,
        2784
      ],
      "id": "ac9e299b-bbd7-4e93-b319-75347d004235",
      "name": "If1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "1a85befe-a620-4132-a561-0b196f81a961"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "f346127f-5f33-4163-8fd8-fbaa38a6c527",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "c0f971a3-78c3-47f7-bd13-0ccf2ee00f7a",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "0b974eb1-a693-4df3-989d-f7de83649604",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "bcb58231-fbde-4cbf-a34e-0210b6ce55d1",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "5",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "caf44e3f-dabd-4186-b2bc-04f73b1c9f00",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1, 2, 3, 4, 5, 9",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        7984,
        2496
      ],
      "id": "88243dbb-68ed-4932-912a-6a92cffaa68f",
      "name": "Switch6"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Empecemos a crear tu tarea.\n\nPaso 1 de 3\n¬øCu√°l es el nombre de la tarea?\n\nEjemplo: Estudiar para un examen\n\n9. Cancelar",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8192,
        2192
      ],
      "id": "2e53eb3f-0155-4a96-8347-64395b9ae3aa",
      "name": "Send a text message15",
      "webhookId": "04d65196-2feb-4edd-854d-eb0ed599f44e"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Ups, esa opci√≥n no existe en este men√∫.\n\nPor favor escribe uno de los n√∫meros que ves en pantalla.\n\nEst√°s en: Men√∫ tareas\nOpciones disponibles: 1 al 5 y 9",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8224,
        2880
      ],
      "id": "df6c4487-1f67-4fe9-b639-8363e350d897",
      "name": "Send a text message16",
      "webhookId": "621877bc-98ca-497d-99c9-d83042a1ad3b"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Perfecto, vamos con tu agenda.\n\n¬øQu√© deseas hacer?\n\n1. Agendar una nueva cita\n2. Consultar tu agenda\n3. Reprogramar una cita\n4. Cancelar una cita\n5. Marcar una cita como completada\n9. Volver al men√∫ principal",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8432,
        2880
      ],
      "id": "10ee1001-1563-4fa5-9728-f91fc0cce88e",
      "name": "Send a text message17",
      "webhookId": "f7cd6eb8-73d2-44f5-a589-cc167c525780"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 1,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    },
                    "id": "9fd2951c-f4fc-409b-a856-f3c50d9bd9c4"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "a0ce7a58-945e-4432-beb1-2d357795186e",
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 2,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "0b69caf7-77ca-48a8-ac1a-558155cc516d",
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 3,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "9b0b7bf2-3274-407a-950e-8392c39aa912",
                    "leftValue": "={{ $('Switch').item.json.paso_actual }}",
                    "rightValue": 4,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        7984,
        3152
      ],
      "id": "34864875-2308-4fe1-bf9a-ad392e76e48c",
      "name": "Switch7"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Paso 2 de 3\n¬øCu√°l es la fecha objetivo de la tarea?\n\nFormato: YYYY-MM-DD\nEjemplo: 2025-12-20\n\n9. Cancelar",
        "additionalFields": {}
      },
      "id": "83128c30-bf3c-411f-9685-9ee075cda61b",
      "name": "Telegram OK8",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8480,
        3120
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "Opci√≥n no v√°lida.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        9008,
        4288
      ],
      "id": "95ac7dfb-bfa7-4cc8-a23c-7de352a28aed",
      "name": "Send a text message18",
      "webhookId": "537b6979-63b9-49c5-8610-35f1ef19571a"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e49fdbbd-e95e-42b7-8e48-8b3cb29491bd"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "58855023-5cd0-49ff-8a4e-042adcdf4212",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "b8fa012e-27ac-4322-82c7-41c4c9cad1fa",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "40cb23eb-e6be-426c-a651-7940bc7f2264",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1, 2, 3",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        8768,
        3920
      ],
      "id": "58866f97-2acf-4348-bee2-52aab9835bc0",
      "name": "Switch8"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9008,
        3648
      ],
      "id": "8002698c-ead8-40c5-a960-3869f7d554b2",
      "name": "Get row(s) in sheet9"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu tarea:\n\nT√≠tulo: {{ $json.datos_parciales_1 }}\nFecha objetivo: {{ $json.datos_parciales_2 }}\nPrioridad: {{ $json.datos_parciales_4 }}\n\n¬øQu√© deseas hacer?\n1. Confirmar y guardar\n2. Editar informaci√≥n\n3. Cancelar",
        "additionalFields": {}
      },
      "id": "a3836c00-ff26-4dee-b4b3-a7e966aa3412",
      "name": "Telegram OK9",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        9472,
        3648
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9008,
        3856
      ],
      "id": "7d2beda8-7771-412d-a763-8f3b9701b183",
      "name": "Get row(s) in sheet10"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu tarea:\n\nT√≠tulo: {{ $json.datos_parciales_1 }}\nFecha objetivo: {{ $json.datos_parciales_2 }}\nPrioridad: {{ $json.datos_parciales_4 }}\n\n¬øQu√© deseas hacer?\n1. Confirmar y guardar\n2. Editar informaci√≥n\n3. Cancelar",
        "additionalFields": {}
      },
      "id": "b45b44f5-862a-4d80-b2fe-c1bcee9cd14e",
      "name": "Telegram OK10",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        9472,
        3856
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9008,
        4064
      ],
      "id": "5cb075bf-c279-4cdd-a695-74b8c984b1ad",
      "name": "Get row(s) in sheet11"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu tarea:\n\nT√≠tulo: {{ $json.datos_parciales_1 }}\nFecha objetivo: {{ $json.datos_parciales_2 }}\nPrioridad: {{ $json.datos_parciales_4 }}\n\n¬øQu√© deseas hacer?\n1. Confirmar y guardar\n2. Editar informaci√≥n\n3. Cancelar",
        "additionalFields": {}
      },
      "id": "929f2b60-cbf5-474d-9cff-b6e6041e3855",
      "name": "Telegram OK11",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        9472,
        4064
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $('Telegram Trigger').item.json.message.text }}",
              "operation": "regex",
              "value2": "^\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])$"
            }
          ]
        }
      },
      "id": "08485031-9afd-43c1-b099-5805c673a49e",
      "name": "Validar formato YYYY-MM-DD1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        8480,
        3312
      ]
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Fecha inv√°lida.\nFormato requerido:YYYY-MM-DD\nEjemplo: 2025-12-20\nIntenta nuevamente.",
        "additionalFields": {}
      },
      "id": "3d3925eb-fa89-4a5b-8d8b-5cda7c50cd79",
      "name": "Telegram Error2",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        8816,
        3456
      ],
      "webhookId": "58122352-e475-4894-bfaf-c3aa5ecc6ce5"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8832,
        3232
      ],
      "id": "f29d8672-fe89-4e72-92ff-604cb13f0f2c",
      "name": "Get row(s) in sheet12"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Paso 3 de 3\n¬øCu√°l es la prioridad de la tarea?\n\n1. Baja\n2. Media\n3. Alta\n9. Cancelar",
        "additionalFields": {}
      },
      "id": "96a312ac-87a8-4193-9f52-3fc61aec6f85",
      "name": "Telegram OK12",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        9296,
        3232
      ],
      "webhookId": "6ca47415-d373-4e4a-ba53-f0e4facfeb2c"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "TAREAS",
            "paso_actual": "3",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $('Telegram Trigger').item.json.message.text }}",
            "datos_parciales_3": "=",
            "datos_parciales_4": "=",
            "datos_parciales_5": "=",
            "datos_parciales_6": "="
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9056,
        3232
      ],
      "id": "77114f90-19a6-4446-9e7f-c0900c26647a",
      "name": "Update row in sheet24"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "TAREAS",
            "paso_actual": "2",
            "datos_parciales_1": "={{ $('Telegram Trigger').item.json.message.text }}",
            "datos_parciales_2": "=",
            "datos_parciales_3": "=",
            "datos_parciales_5": "=",
            "datos_parciales_6": "="
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8256,
        3120
      ],
      "id": "fad07976-e352-4179-9f41-2a37249cf4b4",
      "name": "Update row in sheet25"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "TAREAS",
            "paso_actual": "4",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $json.datos_parciales_2 }}",
            "datos_parciales_3": "={{ $('Telegram Trigger').item.json.message.text }}",
            "datos_parciales_4": "=Baja",
            "datos_parciales_5": "=",
            "datos_parciales_6": "="
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9232,
        3648
      ],
      "id": "474c4220-ba8c-41e3-af0b-1a6839638770",
      "name": "Update row in sheet26"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "TAREAS",
            "paso_actual": "4",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $json.datos_parciales_2 }}",
            "datos_parciales_3": "={{ $('Telegram Trigger').item.json.message.text }}",
            "datos_parciales_4": "=Media",
            "datos_parciales_5": "=",
            "datos_parciales_6": "="
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9232,
        3856
      ],
      "id": "6438953f-49cd-4c29-8246-82afaee1be51",
      "name": "Update row in sheet27"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "TAREAS",
            "paso_actual": "4",
            "datos_parciales_1": "={{ $json.datos_parciales_1 }}",
            "datos_parciales_2": "={{ $json.datos_parciales_2 }}",
            "datos_parciales_3": "={{ $('Telegram Trigger').item.json.message.text }}",
            "datos_parciales_4": "=Alta",
            "datos_parciales_5": "=",
            "datos_parciales_6": "="
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9232,
        4064
      ],
      "id": "ff603155-bad1-4b94-96de-4cc28a3ef38d",
      "name": "Update row in sheet28"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "2149ed1c-6fc1-4214-9bb6-9d73396df7e2"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "c3020235-3026-4758-ba53-3259646bba63",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "81655df1-f7a4-4730-bcb6-91267c74645f",
                    "leftValue": "={{ $('Telegram Trigger').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        8400,
        4464
      ],
      "id": "465f5132-6c0e-43f3-9b16-8193e4cb449c",
      "name": "Switch9"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "MENU"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8704,
        4864
      ],
      "id": "58e902df-b984-4dc8-a68b-72852321d137",
      "name": "Update row in sheet18"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "Cancelado",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8960,
        4864
      ],
      "id": "c526849a-79a9-42c8-88f7-dda14705e9e6",
      "name": "Send a text message20",
      "webhookId": "dc8a9a45-0711-45a4-829a-7ab666828377"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "TAREAS",
            "paso_actual": "1"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8720,
        4672
      ],
      "id": "b7d986f2-6c46-4085-8a69-4ca1cd2a9da6",
      "name": "Update row in sheet19"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Empecemos a crear tu tarea.\n\nPaso 1 de 3\n¬øCu√°l es el nombre de la tarea?\n\nEjemplo: Estudiar para un examen\n\n9. Cancelar",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8976,
        4672
      ],
      "id": "be65160d-6336-4706-b628-290789472d40",
      "name": "Send a text message21",
      "webhookId": "04d65196-2feb-4edd-854d-eb0ed599f44e"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $('Telegram Trigger').item.json.message.chat.first_name }}",
            "pantalla_actual": "TAREAS",
            "paso_actual": "1",
            "datos_parciales_1": "=",
            "timestamp_ultima_interaccion": "{{ $now }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8384,
        2192
      ],
      "id": "fb6d0d72-5722-43a0-b51e-e56eb6029454",
      "name": "Update row in sheet22"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1215835491,
          "mode": "list",
          "cachedResultName": "TAREAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1215835491"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "titulo": "={{ $('Get row(s) in sheet24').item.json.datos_parciales_1 }}",
            "fecha_objetivo": "={{ $('Get row(s) in sheet24').item.json.datos_parciales_2 }}",
            "prioridad": "={{ $('Get row(s) in sheet24').item.json.datos_parciales_4 }}",
            "creado_por": "={{ $('Get row(s) in sheet24').item.json.telegram_user }}",
            "id_tarea": "={{ $('Code in JavaScript7').item.json.id_tarea }}",
            "estado": "={{ $json.estado }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "id_tarea",
              "displayName": "id_tarea",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "titulo",
              "displayName": "titulo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "prioridad",
              "displayName": "prioridad",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "fecha_objetivo",
              "displayName": "fecha_objetivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9616,
        4480
      ],
      "id": "0f36edbd-9684-455d-8bd6-c44328c7efb5",
      "name": "Append row in sheet2"
    },
    {
      "parameters": {
        "jsCode": "const tareas = items.map(i => i.json);\n\nconst pendientes = tareas.filter(t => t.estado === 'Pendiente');\nconst completadas = tareas.filter(t => t.estado === 'Completada');\n\nlet mensaje = 'üìã *Resumen de tareas*\\n\\n';\n\nif (pendientes.length === 0 && completadas.length === 0) {\n  mensaje += 'No tienes tareas registradas.';\n} else {\n  if (pendientes.length > 0) {\n    mensaje += 'üìÖ *Tareas pendientes*\\n\\n';\n    pendientes.forEach((tarea, index) => {\n      mensaje +=\n        `${index + 1}. *${tarea.id_tarea}*\\n` +\n        `${tarea.titulo}\\n` +\n        `${tarea.prioridad}\\n` +\n        `${tarea.fecha_objetivo}\\n\\n`;\n    });\n  } else {\n    mensaje += 'üìÖ *Tareas pendientes*\\n\\nNo tienes tareas pendientes.\\n\\n';\n  }\n\n  if (completadas.length > 0) {\n    mensaje += '‚úÖ *Tareas completadas*\\n\\n';\n    completadas.forEach((tarea, index) => {\n      mensaje +=\n        `${index + 1}. *${tarea.id_tarea}*\\n` +\n        `${tarea.titulo}\\n` +\n        `${tarea.prioridad}\\n` +\n        `${tarea.fecha_objetivo}\\n\\n`;\n    });\n  }\n}\n\nconst chatId = $node[\"Telegram Trigger\"].json.message.chat.id;\n\nreturn [{\n  json: {\n    mensaje,\n    chatId\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        8432,
        2368
      ],
      "id": "2bcf507b-2306-4ec8-8358-2c8c51415b70",
      "name": "Code in JavaScript6"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "={{ $json.result.chat.first_name }}",
            "pantalla_actual": "MENU"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8864,
        2368
      ],
      "id": "043c36b6-142a-4a00-8ecc-23791aa7aea8",
      "name": "Update row in sheet17"
    },
    {
      "parameters": {
        "content": "Perfecto, vamos con tu tarea.\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n2. Consultar tus tareas\n3. Reprogramar una tarea\n4. Cancelar una tarea\n5. Marcar una tarea como completada\n9. Volver al men√∫ principal",
        "height": 256,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        7712,
        2208
      ],
      "typeVersion": 1,
      "id": "5b4d01f5-28b6-4541-95df-51c021993017",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9168,
        4480
      ],
      "id": "efdeaef2-a318-47db-9177-dafb0492e011",
      "name": "Get row(s) in sheet24"
    },
    {
      "parameters": {
        "chatId": "={{ $('Code in JavaScript7').item.json.chatId }}",
        "text": "Tarea completada.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        9840,
        4480
      ],
      "id": "b690598a-3a3f-48c3-b532-d2bb08e2ab3a",
      "name": "Send a text message44",
      "webhookId": "3467d3a3-b94f-4550-b6ce-a4b5b14025a0",
      "retryOnFail": true,
      "maxTries": 5,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1920024994,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1920024994"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "telegram_user": "=",
            "pantalla_actual": "MENU",
            "paso_actual": "={{ $json.Vacio }}",
            "datos_parciales_1": "={{ $json.Vacio }}",
            "datos_parciales_2": "={{ $json.Vacio }}",
            "datos_parciales_3": "={{ $json.Vacio }}",
            "datos_parciales_4": "={{ $json.Vacio }}",
            "datos_parciales_5": "={{ $json.Vacio }}",
            "datos_parciales_6": "={{ $json.Vacio }}",
            "timestamp_ultima_interaccion": "={{ $json.Vacio }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_1",
              "displayName": "datos_parciales_1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_2",
              "displayName": "datos_parciales_2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_3",
              "displayName": "datos_parciales_3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_4",
              "displayName": "datos_parciales_4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_5",
              "displayName": "datos_parciales_5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales_6",
              "displayName": "datos_parciales_6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        10224,
        4480
      ],
      "id": "dc852101-3236-46e0-818b-ed05137e9e0a",
      "name": "Update row in sheet45"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1215835491,
          "mode": "list",
          "cachedResultName": "TAREAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1215835491"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "specifyRangeA1",
              "range": "A:A"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8720,
        4480
      ],
      "id": "3fbc4f8f-776e-4de0-86fe-19261d464aed",
      "name": "Get row(s) in sheet25",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const rows = items;\nconst chatId = $node[\"Telegram Trigger\"].json.message.chat.id;\n\n// Extraer n√∫meros v√°lidos de id_tarea\nconst numeros = rows\n  .map(r => r.json.id_tarea)\n  .filter(id => typeof id === 'string' && /^TAREA-\\d+$/.test(id))\n  .map(id => parseInt(id.split('-')[1], 10));\n\n// Si no hay tareas v√°lidas, iniciar en 001\nconst nextNumber = numeros.length > 0\n  ? Math.max(...numeros) + 1\n  : 1;\n\n// Formato final\nconst newId = `TAREA-${String(nextNumber).padStart(3, '0')}`;\n\nreturn [{\n  json: {\n    id_tarea: newId,\n    chatId: chatId\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        8928,
        4480
      ],
      "id": "b81bae6e-e285-4d5e-8e62-fd830bfcce8f",
      "name": "Code in JavaScript7"
    },
    {
      "parameters": {
        "jsCode": "\nconst fecha = $input.first().json.datos_parciales_2; // YYYY-MM-DD\n\nif (!fecha) {\n  return [{\n    json: {\n      estado: 'Pendiente'\n    }\n  }];\n}\n\nconst fechaTarea = new Date(`${fecha}`);\n\nconst ahora = new Date();\n\nconst estado = fechaTarea < ahora ? 'Completada' : 'Pendiente';\n\n\nreturn [{\n  json: {\n    estado\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        9392,
        4480
      ],
      "id": "92fd475a-84eb-423b-86e6-4375710fcf78",
      "name": "Code in JavaScript8"
    },
    {
      "parameters": {
        "chatId": "={{ $('Code in JavaScript7').item.json.chatId }}",
        "text": "=¬øEn qu√© te puedo ayudar hoy?\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador\n\nSugerencia:\n\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        10448,
        4480
      ],
      "id": "8a90e0b9-6645-4748-8417-87cfa9eefc05",
      "name": "Send a text message45",
      "webhookId": "67f4070f-d09c-4373-8dcb-d45994d560f6",
      "retryOnFail": true,
      "maxTries": 5
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d825242d-7e8d-42fc-9944-3a651f639662",
              "name": "Vacio",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        10032,
        4480
      ],
      "id": "9a6ef3de-10f2-4adb-8a9d-8c4cc9b58899",
      "name": "Edit Fields9"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI",
          "mode": "list",
          "cachedResultName": "AgendaBot Services",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1215835491,
          "mode": "list",
          "cachedResultName": "TAREAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Fr0SIHz1fqAEYHHRrOVIQoVQisSI1TMWBi5-NYTETkI/edit#gid=1215835491"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8192,
        2368
      ],
      "id": "10c94df9-e595-4ce5-bcfe-e442a711d40a",
      "name": "Get row(s) in sheet26"
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.mensaje }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8656,
        2368
      ],
      "id": "a268f2c9-542e-48de-8f43-bd6181e6a804",
      "name": "Send a text message46",
      "webhookId": "85b21991-fc09-4cf9-ae30-9158610be872"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Por favor, escribe el ID de la tarea que deseas reprogramar.\nEjemplo: TAREA-003\n",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        8320,
        2544
      ],
      "id": "934b14bb-0cbc-48d4-913a-9960499af721",
      "name": "Send a text message47",
      "webhookId": "6d97bd7b-0b97-4ed2-9ff8-a3a9d569216b"
    }
  ],
  "pinData": {},
  "connections": {
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet1": {
      "main": [
        []
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "Send a text message2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message14",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [],
        [],
        [],
        [],
        [],
        [
          {
            "node": "Send a text message5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message2": {
      "main": [
        [
          {
            "node": "Send a text message3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet2": {
      "main": [
        []
      ]
    },
    "Send a text message5": {
      "main": [
        [
          {
            "node": "Send a text message6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message4": {
      "main": [
        [
          {
            "node": "Update row in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch2": {
      "main": [
        [
          {
            "node": "Send a text message9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet14",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message24",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message32",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message39",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message7": {
      "main": [
        [
          {
            "node": "Send a text message8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message9": {
      "main": [
        [
          {
            "node": "Update row in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Switch2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validar formato YYYY-MM-DD": {
      "main": [
        [
          {
            "node": "Update row in sheet5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Telegram Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch3": {
      "main": [
        [
          {
            "node": "Validar formato YYYY-MM-DD",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Validar formato HH:MM",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet5": {
      "main": [
        [
          {
            "node": "Telegram OK",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validar formato HH:MM": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Telegram Error1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet1": {
      "main": [
        [
          {
            "node": "Update row in sheet6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet6": {
      "main": [
        [
          {
            "node": "Telegram OK1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet7": {
      "main": [
        [
          {
            "node": "Telegram OK2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet2": {
      "main": [
        [
          {
            "node": "Update row in sheet7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet8": {
      "main": [
        [
          {
            "node": "Telegram OK3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet3": {
      "main": [
        [
          {
            "node": "Update row in sheet8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet10": {
      "main": [
        [
          {
            "node": "Telegram OK5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet5": {
      "main": [
        [
          {
            "node": "Update row in sheet10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch5": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet11": {
      "main": [
        [
          {
            "node": "Telegram OK6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet6": {
      "main": [
        [
          {
            "node": "Update row in sheet11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet12": {
      "main": [
        [
          {
            "node": "Telegram OK7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet7": {
      "main": [
        [
          {
            "node": "Update row in sheet12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch4": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row in sheet15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row in sheet14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet8": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Send a text message11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message11": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet14": {
      "main": [
        [
          {
            "node": "Send a text message12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet15": {
      "main": [
        [
          {
            "node": "Send a text message13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message14": {
      "main": [
        [
          {
            "node": "Update row in sheet16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet4": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get row(s) in sheet8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message": {
      "main": [
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message1": {
      "main": [
        [
          {
            "node": "Update row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet13": {
      "main": [
        [
          {
            "node": "Send a text message22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Update row in sheet13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Send a text message11",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send a text message22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet14": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Send a text message23",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message23": {
      "main": [
        [
          {
            "node": "Update row in sheet9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message24": {
      "main": [
        [
          {
            "node": "Update row in sheet20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet15": {
      "main": [
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Send a text message25",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row in sheet21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet21": {
      "main": [
        [
          {
            "node": "Send a text message26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If4": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet16",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch10": {
      "main": [
        [
          {
            "node": "Send a text message27",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message28",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message29",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validar formato YYYY-MM-DD2": {
      "main": [
        [
          {
            "node": "Update row in sheet23",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Telegram Error3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet23": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message27": {
      "main": [
        [
          {
            "node": "Update row in sheet29",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet16": {
      "main": [
        [
          {
            "node": "Switch10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message28": {
      "main": [
        [
          {
            "node": "Update row in sheet30",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message29": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Update row in sheet31",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch11": {
      "main": [
        [
          {
            "node": "Validar formato YYYY-MM-DD2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Validar formato HH:MM1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validar formato HH:MM1": {
      "main": [
        [
          {
            "node": "Update row in sheet32",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Telegram Error4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet33": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet32": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet34": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "Update row in sheet35",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet35": {
      "main": [
        [
          {
            "node": "Telegram OK4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields4": {
      "main": [
        [
          {
            "node": "Update row in sheet36",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet36": {
      "main": [
        [
          {
            "node": "Telegram OK13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram OK4": {
      "main": [
        [
          {
            "node": "Send a text message30",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram OK13": {
      "main": [
        [
          {
            "node": "Send a text message31",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields5": {
      "main": [
        [
          {
            "node": "Update row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet17": {
      "main": [
        [
          {
            "node": "Update row in sheet34",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet18": {
      "main": [
        [
          {
            "node": "Update row in sheet33",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message32": {
      "main": [
        [
          {
            "node": "Update row in sheet37",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet19": {
      "main": [
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "If5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If5": {
      "main": [
        [
          {
            "node": "Send a text message33",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row in sheet38",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet38": {
      "main": [
        [
          {
            "node": "Send a text message34",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If6": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet19",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete rows or columns from sheet": {
      "main": [
        [
          {
            "node": "Edit Fields6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If7": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet21",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message37",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet20": {
      "main": [
        [
          {
            "node": "Delete rows or columns from sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet21": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message35": {
      "main": [
        [
          {
            "node": "Send a text message36",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message37": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet39": {
      "main": [
        [
          {
            "node": "Send a text message35",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields6": {
      "main": [
        [
          {
            "node": "Update row in sheet39",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields7": {
      "main": [
        [
          {
            "node": "Update row in sheet40",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet40": {
      "main": [
        [
          {
            "node": "Send a text message38",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet22": {
      "main": [
        [
          {
            "node": "Code in JavaScript5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript5": {
      "main": [
        [
          {
            "node": "If9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If9": {
      "main": [
        [
          {
            "node": "Send a text message40",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row in sheet42",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet42": {
      "main": [
        [
          {
            "node": "Send a text message41",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If8": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet22",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet23",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet23": {
      "main": [
        [
          {
            "node": "Update row in sheet44",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message42": {
      "main": [
        [
          {
            "node": "Send a text message43",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet43": {
      "main": [
        [
          {
            "node": "Send a text message42",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields8": {
      "main": [
        [
          {
            "node": "Update row in sheet43",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message39": {
      "main": [
        [
          {
            "node": "Update row in sheet41",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet44": {
      "main": [
        [
          {
            "node": "Edit Fields8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Switch6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch6": {
      "main": [
        [
          {
            "node": "Send a text message15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet26",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message47",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [],
        [
          {
            "node": "Send a text message16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message15": {
      "main": [
        [
          {
            "node": "Update row in sheet22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message16": {
      "main": [
        [
          {
            "node": "Send a text message17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch7": {
      "main": [
        [
          {
            "node": "Update row in sheet25",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Validar formato YYYY-MM-DD1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch8": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet10",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet11",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet9": {
      "main": [
        [
          {
            "node": "Update row in sheet26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet10": {
      "main": [
        [
          {
            "node": "Update row in sheet27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet11": {
      "main": [
        [
          {
            "node": "Update row in sheet28",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validar formato YYYY-MM-DD1": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet12",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Telegram Error2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet12": {
      "main": [
        [
          {
            "node": "Update row in sheet24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet24": {
      "main": [
        [
          {
            "node": "Telegram OK12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet25": {
      "main": [
        [
          {
            "node": "Telegram OK8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet26": {
      "main": [
        [
          {
            "node": "Telegram OK9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet27": {
      "main": [
        [
          {
            "node": "Telegram OK10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet28": {
      "main": [
        [
          {
            "node": "Telegram OK11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch9": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet25",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row in sheet19",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row in sheet18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet18": {
      "main": [
        [
          {
            "node": "Send a text message20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet19": {
      "main": [
        [
          {
            "node": "Send a text message21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet2": {
      "main": [
        [
          {
            "node": "Send a text message44",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript6": {
      "main": [
        [
          {
            "node": "Send a text message46",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet24": {
      "main": [
        [
          {
            "node": "Code in JavaScript8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message44": {
      "main": [
        [
          {
            "node": "Edit Fields9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet45": {
      "main": [
        [
          {
            "node": "Send a text message45",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet25": {
      "main": [
        [
          {
            "node": "Code in JavaScript7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript7": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript8": {
      "main": [
        [
          {
            "node": "Append row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields9": {
      "main": [
        [
          {
            "node": "Update row in sheet45",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet26": {
      "main": [
        [
          {
            "node": "Code in JavaScript6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message46": {
      "main": [
        [
          {
            "node": "Update row in sheet17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "706efb1c-8443-4ec3-9032-8c04229edeab",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "2461c286aed77d4c7fbe9ed395a19fb04c04889a0855697eb6af572c2383f548"
  },
  "id": "oLcwfXTX5fJOF29bwAYKV",
  "tags": []
}